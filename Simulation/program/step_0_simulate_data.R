library(igraph)setwd(file.path("simu_data"))n  = 400 # sample sizeps = c(100,200,300)min.beta=0.1set.seed(99)# ----------------------------------------------------------------------------# simulate data from BA model# ----------------------------------------------------------------------------for(p in ps){    for(e in 1:2){        A = list()        X = list()        for(i in 1:100){            Ai = as(igraph.to.graphNEL(barabasi.game(n = p, m = e)), "matrix")            w  = which(Ai != 0)            Ai[w] = runif(n = length(w), min = min.beta, max = 1)            Sigh = solve(diag(p) - Ai)                        id.shuffle = sample(1:p, p, replace = FALSE)                        Xi = rmvnorm(n = n, sigma = Sigh %*% t(Sigh))            Xi = Xi[,id.shuffle]            Ai = Ai[id.shuffle, id.shuffle]                        A[[i]] = Ai            X[[i]] = Xi        }              save(A, X, file=sprintf("BA_simu_n_%d_p_%d_e_%d_min_beta_%g_100A.RData", n, p, e, min.beta))            }}# ----------------------------------------------------------------------------# simulate data from ER model# ----------------------------------------------------------------------------n  = 400 # sample sizeps = c(100, 200, 300)set.seed(99)for(p in ps){  for(pE in c(2/p, 4/p)){    A = list()    X = list()        for(i in 1:100){      Ai = matrix(0, p, p)      w  = which(lower.tri(Ai))      ruf = runif(n = length(w), min = min.beta, max = 1)      Ai[w] = rbinom(n = length(w), size = 1, prob = pE) * ruf      Sigh = solve(diag(p) - Ai)            id.shuffle = sample(1:p, p, replace = FALSE)            Xi = rmvnorm(n = n, sigma = Sigh %*% t(Sigh))      Xi = Xi[,id.shuffle]      Ai = Ai[id.shuffle, id.shuffle]            A[[i]] = Ai      X[[i]] = Xi    }    save(A, X, file=sprintf("ER_simu_n_%d_p_%d_pE_%.2e_min_beta_%g_100A.RData", n, p, pE, min.beta))  }}